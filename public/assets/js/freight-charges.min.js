async function displayData(t,e,a){if(t.length<1)freightDataDiv.innerHTML="",freightDataDiv.innerHTML+='<h2 class="message">No results found</h2>',resultTotals.innerHTML="Showing 0 to 0 of 0 results";else{freightDataDiv.innerHTML="";let r=document.createElement("table");for(let n=e;n<a+1&&!(n>t.length-1);n++){if(n===e){let t=document.createElement("tr");heading.forEach(e=>{let a=document.createElement("th");a.textContent=e,t.appendChild(a)}),r.appendChild(t)}let a=document.createElement("tr"),i=document.createElement("td");i.textContent=t[n][0];let d=document.createElement("td");d.textContent=t[n][1];let l=document.createElement("td");l.textContent=t[n][2],"Minimum"===t[n][1]&&(d.classList.add("minimum-red"),i.classList.add("minimum-red"),l.classList.add("minimum-red")),a.appendChild(i),a.appendChild(d),a.appendChild(l),r.appendChild(a)}freightDataDiv.appendChild(r),resultTotals.innerHTML=`Showing ${e+1} to ${a>t.length?t.length:a+1} of ${t.length} results`}prevButton.disabled=0===e,0!==t.length&&(a>=t.length-1?nextButton.disabled=!0:nextButton.disabled=!1)}function searchFreightData(t){t.length>0&&(filteredData=[],freightData.forEach(e=>{null!=e[0]&&e[0].toLowerCase().includes(t.toLowerCase())&&filteredData.push(e)}),freightDataDiv.innerHTML="",resetStartEnd(),displayData(filteredData,freightStart,freightEnd))}function resetStartEnd(){freightStart=0,freightEnd=24}let freightSearchInput=document.querySelector(".search"),nextButton=document.querySelector("#next"),prevButton=document.querySelector("#prev"),resultTotals=document.querySelector("#result-totals"),freightDataDiv=document.querySelector("#freight-data"),range="Sheet1!A:C",heading=["LOCATION","GRADE","PRICE"],filteredData=[],freightData=[],freightStart=0,freightEnd=24;(async function(){freightData=await fetch("https://api.leafland.co.nz/default/get-freight-data-file").then(t=>t.json()).catch(t=>{}),await displayData(freightData,freightStart,freightEnd),document.body.classList.add("page-loaded"),freightSearchInput.removeAttribute("disabled"),freightSearchInput.addEventListener("input",t=>{t.target.value.length<=0?displayData(freightData,freightStart,freightEnd):searchFreightData(t.target.value)})})(),nextButton.addEventListener("click",()=>{freightStart+=25,freightEnd+=25,filteredData.length>1&&freightSearchInput.value.length>0?displayData(filteredData,freightStart,freightEnd):displayData(freightData,freightStart,freightEnd)}),prevButton.addEventListener("click",()=>{freightStart-=25,freightEnd-=25,(freightStart<0||freightEnd<0)&&resetStartEnd(),filteredData.length>1&&freightSearchInput.value.length>0?displayData(filteredData,freightStart,freightEnd):displayData(freightData,freightStart,freightEnd)});