function resetStartEnd(){start=0,end=11}async function getSearchData(){searchData=await fetch("https://api.leafland.co.nz/default/get-product-data?type=tree-finder").then(e=>e.json()).then(e=>e).catch(e=>{})}async function getSearchImages(){searchResultsImages=await fetch("https://api.leafland.co.nz/default/get-image-data").then(e=>e.json()).then(e=>e).catch(e=>{})}async function search(e){e=e.split(" ");for(let a=0;a<e.length;a++)""!==e[a]&&0!==e[a].length||(e.splice(a,1),a--);if(e.length>0){searchResults=[];let a="",t="",s="",r="";for(let c=0;c<searchData.length;c++){a="",t="",s="",r="",-1!==searchData[c].uses.search("hedging-screening")&&(a=`${a} hedging hedge hedges hedged`),-1!==searchData[c].uses.search("birds-bees")&&(a=`${a} bird birds bees bee`),-1!==searchData[c].uses.search("driveways-avenues")&&(a=`${a} driveway driveways avenue avenues`),-1!==searchData[c].uses.search("paddocks-shade")&&(a=`${a} paddocks paddock field farm shade shading`),-1!==searchData[c].uses.search("pleaching")&&(a=`${a} pleaching pleached pleach`),-1!==searchData[c].uses.search("small-garden")&&(a=`${a} small`),-1!==searchData[c].uses.search("street")&&(a=`${a} street`),-1!==searchData[c].uses.search("topiary")&&(a=`${a} topiary topiaried ball`),-1!==searchData[c].uses.search("narrow-spaces")&&(a=`${a} narrow restricted thin`),-1!==searchData[c].uses.search("attracts-birds")&&(a=`${a} attracts birds bird`),-1!==searchData[c].uses.search("attracts-bees")&&(a=`${a} attracts bees bee`),-1!==searchData[c].tolerates.search("dry")&&(t=`${t} dry hot drought`),-1!==searchData[c].tolerates.search("coastal")&&(t=`${t} coastal coast beach sea seaside`),-1!==searchData[c].tolerates.search("wet")&&(t=`${t} wet damp moist sodden flood`),-1!==searchData[c].tolerates.search("windy")&&(t=`${t} windy wind gale exposed`),-1!==searchData[c].tolerates.search("clay")&&(t=`${t} clay heavy`),-1!==searchData[c].types.search("conifer")&&(s=`${s} conifer coniferous`),-1!==searchData[c].types.search("edible")&&(s=`${s} edible fruit nut`),-1!==searchData[c].types.search("weeping")&&(s=`${s} weeping pendula pendulum drooping`),r=`${searchData[c].botanicalName.replace(/ā/g,"a").replace(/ē/g,"e").replace(/ī/g,"i").replace(/ō/g,"o").replace(/ū/g,"u")} ${searchData[c].commonName.replace(/ā/g,"a").replace(/ē/g,"e").replace(/ī/g,"i").replace(/ō/g,"o").replace(/ū/g,"u")} ${a} ${t} ${searchData[c].winterFoliage} ${searchData[c].origin} ${s} ${searchData[c].flowerColor} ${searchData[c].foliageColor} ${searchData[c].autumnColor}`.replace(/'/g,"").replace(/"/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/,/g,"").replace(/-/g,"").replace(/-x-/g,"").replace(/\s/g,"").toLowerCase();for(let a=0;a<e.length;a++){if(-1===r.search(e[a].toLowerCase())){add=!1;break}add=!0}add&&searchResults.push(searchData[c])}}else searchResults=[]}async function displayResults(e){end>=e.length-1?searchLoadMoreButton.disabled=!0:searchLoadMoreButton.disabled=!1;for(let a=start;a<end+1&&!(a>e.length-1);a++){let t=[],s=document.createElement("div");s.classList.add("search-result");let r=document.createElement("div");r.classList.add("surface-content");let c=document.createElement("div");c.classList.add("result-title");let n=document.createElement("p");n.classList.add("result-botanical-name");let l=document.createElement("p");l.classList.add("result-common-name");let o=document.createElement("a");o.href=`/trees/${e[a].url}/`,o.classList.add("button"),o.textContent="View Tree",""===e[a].commonName?n.textContent=e[a].botanicalName:(n.textContent=`${e[a].botanicalName}`,l.innerHTML=`<span class="accent-color">${e[a].commonName}</span>`,c.insertAdjacentElement("afterbegin",l));for(let s=0;s<searchResultsImages.length;s++)searchResultsImages[s].split("/",4)[3]!==`${e[a].url}.jpg`&&searchResultsImages[s].split("/",4)[3]!==`${e[a].url}.jpeg`||t.push(searchResultsImages[s]);let d=document.createElement("div"),i=document.createElement("img");i.src=`https://ik.imagekit.io/leafland/${t[t.length-1]}?tr=w-500,q-75,pr-true,f-auto`,i.width="500",i.height="500",i.loading="lazy",c.insertAdjacentElement("afterbegin",n),d.insertAdjacentElement("afterbegin",i),s.appendChild(d),r.appendChild(c),r.appendChild(o),s.appendChild(r),s.style.setProperty("--animation-order",`${a%12}`),s.classList.add("search-result-loaded"),searchResultsInner.appendChild(s)}}let typingTimer,searchInput=document.querySelector("#search"),searchResultsInner=document.querySelector("#search-results-inner"),openSearch=document.querySelector("#open-search"),closeSearch=document.querySelector("#close-search"),searchLoadMoreButton=document.querySelector("#search-load-more"),searchReturnToTopButton=document.querySelector("#search-return-to-top"),searchData=[],searchResults=[],searchResultsImages=[],start=0,end=11,doneTypingInterval=500;(async function(){searchInput.disabled=!0,await getSearchData(),await getSearchImages(),searchInput.disabled=!1,searchInput.addEventListener("keyup",e=>{clearTimeout(typingTimer),searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="",document.body.classList.remove("search-loaded"),typingTimer=setTimeout(()=>{(async function(){if(await search(e.target.value),searchResults.length>0)searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="",resetStartEnd(),await displayResults(searchResults),searchLoadMoreButton.style.setProperty("visibility","visible"),searchReturnToTopButton.style.setProperty("visibility","visible"),document.body.classList.add("search-loaded");else{searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="";let e=document.createElement("p");e.textContent="No results.",e.classList.add("empty-message"),searchResultsInner.appendChild(e),document.body.classList.add("search-loaded")}})()},doneTypingInterval)})})(),openSearch.addEventListener("click",()=>{document.body.classList.add("search-open")}),closeSearch.addEventListener("click",()=>{document.body.classList.remove("search-open"),document.body.classList.remove("search-loaded"),searchInput.value=""}),searchLoadMoreButton.addEventListener("click",()=>{start+=12,end+=12,displayResults(searchResults)}),searchReturnToTopButton.addEventListener("click",()=>{document.querySelector("#search-overlay").scroll({top:0,left:0})});