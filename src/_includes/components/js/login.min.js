let loginForm=document.querySelector("#login-form"),returnMessage=document.querySelector("#return-message"),logOutButton=document.querySelector("#log-out"),login=!1,openLogin=document.querySelector("#open-login"),closeLogin=document.querySelector("#close-login"),emails=[];async function logIn(event){document.querySelector("#log-in").value="Logging in...",emails=await fetch("/public/emails.json").then(response=>response.json()).catch(error=>{}),emails.includes(event.target[0].value.toLowerCase())&&(login=!0)}async function sendLoginLink(event){const endpoint="https://api.leafland.co.nz/default/send-login-link",body=JSON.stringify({email:event.target[0].value,loginPage:window.location.href}),requestOptions={method:"POST",body:body};fetch(endpoint,requestOptions).then(response=>{}).catch(error=>{})}loginForm.addEventListener("submit",event=>{event.preventDefault(),localStorage.setItem("loginPage",`${window.location.href}`),async function(){await logIn(event),login&&void 0!==login?(await sendLoginLink(event),returnMessage.textContent="Check your inbox for the login link.",document.querySelector("#log-in").value="Log in",document.querySelector("#log-in").disabled=!0,localStorage.setItem("loggedIn","true"),window.location.reload()):(returnMessage.textContent="Invalid email address. Please try again.",document.querySelector("#log-in").value="Log in",document.querySelector("#log-in").disabled=!1,localStorage.setItem("loggedIn","false"))}()}),openLogin.addEventListener("click",()=>{document.querySelector("#log-in").disabled=!1,returnMessage.textContent="",document.body.classList.add("login-open")}),closeLogin.addEventListener("click",()=>{document.body.classList.remove("login-open")}),logOutButton.addEventListener("click",()=>{localStorage.setItem("loggedIn","false"),localStorage.setItem("reloaded","false"),window.location.reload()});