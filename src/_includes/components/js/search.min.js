let searchInput=document.querySelector("#search"),searchResultsInner=document.querySelector("#search-results-inner"),openSearch=document.querySelector("#open-search"),closeSearch=document.querySelector("#close-search"),searchLoadMoreButton=document.querySelector("#search-load-more"),searchReturnToTopButton=document.querySelector("#search-return-to-top"),searchData=[],searchResults=[],start=0,end=11,typingTimer;function resetStartEnd(){start=0,end=11}async function getSearchData(){searchData=await fetch("/public/trees.json").then(response=>response.json()).then(data=>data).catch(error=>{})}async function search(terms){terms=terms.split(" ");for(let i=0;i<terms.length;i++)""!==terms[i]&&0!==terms[i].length||(terms.splice(i,1),i--);if(terms.length>0){searchResults=[];let usesValue="",toleratesValue="",typesValue="",compareValue="";for(let i=0;i<searchData.length;i++){usesValue="",toleratesValue="",typesValue="",compareValue="",-1!==searchData[i].uses.search("hedging-screening")&&(usesValue=`${usesValue} hedging hedge hedges hedged `),-1!==searchData[i].uses.search("birds-bees")&&(usesValue=`${usesValue} bird birds bees bee `),-1!==searchData[i].uses.search("driveways-avenues")&&(usesValue=`${usesValue} driveway driveways avenue avenues `),-1!==searchData[i].uses.search("paddocks-shade")&&(usesValue=`${usesValue} paddocks paddock field farm shade shading `),-1!==searchData[i].uses.search("pleaching")&&(usesValue=`${usesValue} pleaching pleached pleach `),-1!==searchData[i].uses.search("small-garden")&&(usesValue=`${usesValue} small `),-1!==searchData[i].uses.search("street")&&(usesValue=`${usesValue} street `),-1!==searchData[i].uses.search("topiary")&&(usesValue=`${usesValue} topiary topiaried ball `),-1!==searchData[i].uses.search("narrow-spaces")&&(usesValue=`${usesValue} narrow restricted thin `),-1!==searchData[i].uses.search("attracts-birds")&&(usesValue=`${usesValue} attracts birds bird `),-1!==searchData[i].uses.search("attracts-bees")&&(usesValue=`${usesValue} attracts bees bee `),-1!==searchData[i].tolerates.search("dry")&&(toleratesValue=`${toleratesValue} dry hot drought `),-1!==searchData[i].tolerates.search("coastal")&&(toleratesValue=`${toleratesValue} coastal coast beach sea seaside `),-1!==searchData[i].tolerates.search("wet")&&(toleratesValue=`${toleratesValue} wet damp moist sodden flood `),-1!==searchData[i].tolerates.search("windy")&&(toleratesValue=`${toleratesValue} windy wind gale exposed `),-1!==searchData[i].tolerates.search("clay")&&(toleratesValue=`${toleratesValue} clay heavy `),-1!==searchData[i].types.search("conifer")&&(typesValue=`${typesValue} conifer coniferous `),-1!==searchData[i].types.search("edible")&&(typesValue=`${typesValue} edible fruit nut `),-1!==searchData[i].types.search("weeping")&&(typesValue=`${typesValue} weeping pendula pendulum drooping `);for(let j=0;j<searchData[i].synonyms.length;j++)compareValue+=`${searchData[i].synonyms[j]} `.replace(/'/g,"").replace(/"/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/,/g," ").replace(/-/g," ").replace(/-x-/g," ").replace(/ã/g,"a").replace(/é/g,"e").replace(/ā/g,"a").replace(/ē/g,"e").replace(/ī/g,"i").replace(/ō/g,"o").replace(/ū/g,"u").toLowerCase();compareValue+=`${searchData[i].genus} ${searchData[i].species} ${searchData[i].hybrid} ${searchData[i].subspecies} ${searchData[i].variety} ${searchData[i].form} ${searchData[i].cultivar} ${searchData[i].commonName} ${searchData[i].winterFoliage} ${searchData[i].origin} ${searchData[i].soilType} ${searchData[i].uses} ${searchData[i].sunShade} ${searchData[i].tolerates} ${searchData[i].types} ${searchData[i].stem.summer} ${searchData[i].stem.autumn} ${searchData[i].stem.winter} ${searchData[i].stem.spring} ${searchData[i].flowers.summer} ${searchData[i].flowers.autumn} ${searchData[i].flowers.winter} ${searchData[i].flowers.spring} ${searchData[i].foliage.summer} ${searchData[i].foliage.autumn} ${searchData[i].foliage.winter} ${searchData[i].foliage.spring} ${searchData[i].fruit.summer} ${searchData[i].fruit.autumn} ${searchData[i].fruit.winter} ${searchData[i].fruit.spring} ${typesValue} ${usesValue} ${toleratesValue}`.replace(/'/g,"").replace(/"/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/,/g," ").replace(/-/g," ").replace(/-x-/g," ").replace(/ã/g,"a").replace(/é/g,"e").replace(/ā/g,"a").replace(/ē/g,"e").replace(/ī/g,"i").replace(/ō/g,"o").replace(/ū/g,"u").toLowerCase();for(let j=0;j<terms.length;j++){if(-1===compareValue.search(terms[j].replace(/'/g,"").replace(/"/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/,/g," ").replace(/-/g," ").replace(/-x-/g," ").replace(/ã/g,"a").replace(/é/g,"e").replace(/ā/g,"a").replace(/ē/g,"e").replace(/ī/g,"i").replace(/ō/g,"o").replace(/ū/g,"u").toLowerCase())){add=!1;break}add=!0}add&&searchResults.push(searchData[i])}}else searchResults=[]}async function displayResults(results){end>=results.length-1?searchLoadMoreButton.disabled=!0:searchLoadMoreButton.disabled=!1;for(let i=start;i<end+1&&!(i>results.length-1);i++){let resultDiv=document.createElement("div");resultDiv.classList.add("search-result");let surfaceContent=document.createElement("div");surfaceContent.classList.add("surface-content");let titleDiv=document.createElement("div");titleDiv.classList.add("result-title");let resultTitle=document.createElement("p");resultTitle.classList.add("result-botanical-name");let resultSubtitle=document.createElement("p");resultSubtitle.classList.add("result-common-name");let resultLink=document.createElement("a");resultLink.href=`/trees/${results[i].url}/`,resultLink.classList.add("button"),resultLink.textContent="View Tree",""!==results[i].cultivar?""!==results[i].form?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> f. <i>${results[i].form}</i> '${results[i].cultivar}'`:""!==results[i].variety?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> var. <i>${results[i].variety}</i> '${results[i].cultivar}'`:""!==results[i].subspecies?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> subsp. <i>${results[i].subspecies}</i> '${results[i].cultivar}'`:""!==results[i].hybrid?-1!==results[i].hybrid.search(" x ")?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].hybrid}</i> '${results[i].cultivar}'`:resultTitle.innerHTML=`<i>${results[i].genus}</i> x <i>${results[i].hybrid}</i> '${results[i].cultivar}'`:""!==results[i].species?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> '${results[i].cultivar}'`:resultTitle.innerHTML=`<i>${results[i].genus}</i> '${results[i].cultivar}'`:""!==results[i].form?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> f. <i>${results[i].form}</i>`:""!==results[i].variety?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> var. <i>${results[i].variety}</i>`:""!==results[i].subspecies?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i> subsp. <i>${results[i].subspecies}</i>`:""!==results[i].hybrid?-1!==results[i].hybrid.search(" x ")?resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].hybrid}</i>`:resultTitle.innerHTML=`<i>${results[i].genus}</i> x <i>${results[i].hybrid}</i>`:resultTitle.innerHTML=`<i>${results[i].genus}</i> <i>${results[i].species}</i>`,resultSubtitle.innerHTML=`<span class="accent-color">${results[i].commonName}</span>`,titleDiv.insertAdjacentElement("afterbegin",resultSubtitle);let imageDiv=document.createElement("div"),resultImage=document.createElement("img");resultImage.src=`https://leafland.imgix.net/images/trees/${results[i].mainImage}?auto=format&w=500&q=74`,resultImage.width="500",resultImage.height="500",resultImage.loading="lazy",resultImage.alt=`${results[i].url.replace(/-/g," ")}`,titleDiv.insertAdjacentElement("afterbegin",resultTitle),imageDiv.insertAdjacentElement("afterbegin",resultImage),resultDiv.appendChild(imageDiv),surfaceContent.appendChild(titleDiv),surfaceContent.appendChild(resultLink),resultDiv.appendChild(surfaceContent),resultDiv.style.setProperty("--animation-order",`${i%12}`),resultDiv.classList.add("search-result-loaded"),searchResultsInner.appendChild(resultDiv)}}let doneTypingInterval=500;!async function init(){searchInput.disabled=!0,await getSearchData(),searchInput.disabled=!1,searchInput.addEventListener("keyup",event=>{clearTimeout(typingTimer),searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="",document.body.classList.remove("search-loaded"),typingTimer=setTimeout(()=>{!async function(){if(await search(event.target.value),searchResults.length>0)searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="",resetStartEnd(),await displayResults(searchResults),searchLoadMoreButton.style.setProperty("visibility","visible"),searchReturnToTopButton.style.setProperty("visibility","visible"),document.body.classList.add("search-loaded");else{searchLoadMoreButton.style.setProperty("visibility","hidden"),searchReturnToTopButton.style.setProperty("visibility","hidden"),searchResultsInner.innerHTML="";let emptyMessage=document.createElement("p");emptyMessage.textContent="No results.",emptyMessage.classList.add("empty-message"),searchResultsInner.appendChild(emptyMessage),document.body.classList.add("search-loaded")}}()},doneTypingInterval)})}(),openSearch.addEventListener("click",()=>{document.body.classList.add("search-open")}),closeSearch.addEventListener("click",()=>{document.body.classList.remove("search-open"),document.body.classList.remove("search-loaded"),searchInput.value=""}),searchLoadMoreButton.addEventListener("click",()=>{start+=12,end+=12,displayResults(searchResults)}),searchReturnToTopButton.addEventListener("click",()=>{document.querySelector("#search-overlay").scroll({top:0,left:0})});