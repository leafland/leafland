let treeWrapper=document.querySelector("#tree-wrapper"),content=document.querySelector("#content"),clearCheckboxFilter=document.querySelector("#clear-checkbox-filter"),clearSelectFilter=document.querySelector("#clear-select-filter"),treeFinderStart=0,treeFinderEnd=11,imageDataSubset=[],inputsArray=document.querySelectorAll(".filter-input"),optionsArray=document.querySelectorAll("option"),treeFilter=[],heightsArray=[],widthsArray=[],filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]};sessionStorage.getItem("filterSettings")&&(filterSettings=JSON.parse(sessionStorage.getItem("filterSettings"))),!1===filterSettings.empty?(clearCheckboxFilter.disabled=!1,clearSelectFilter.disabled=!1):(clearCheckboxFilter.disabled=!0,clearSelectFilter.disabled=!0);for(let i=0;i<optionsArray.length;i++)filterSettings[`${optionsArray[i].dataset.category}`].includes(optionsArray[i].value)?optionsArray[i].selected=!0:optionsArray[i].selected=!1;for(let i=0;i<inputsArray.length;i++)filterSettings[`${inputsArray[i].dataset.category}`].includes(inputsArray[i].value)?(inputsArray[i].checked=!0,document.querySelector(`#${inputsArray[i].dataset.category}`).textContent=parseInt(document.querySelector(`#${inputsArray[i].dataset.category}`).textContent)+1):inputsArray[i].checked=!1;let treeFinderData=[],buttonDiv=document.querySelector("#button-div"),loadMoreButton=document.querySelector("#load-more"),returnToTopButton=document.querySelector("#return-to-top"),filteredData=[];class Accordion{constructor(el){this.el=el,this.summary=el.querySelector("summary"),this.content=el.querySelector(".options-group"),this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.summary.addEventListener("click",e=>this.onClick(e))}onClick(e){e.preventDefault(),this.el.style.overflow="hidden",this.isClosing||!this.el.open?this.open():(this.isExpanding||this.el.open)&&this.shrink()}shrink(){this.isClosing=!0;const startHeight=`${this.el.offsetHeight}px`,endHeight=`${this.summary.offsetHeight}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[startHeight,endHeight]},{duration:300,easing:"ease-out"}),this.animation.onfinish=()=>this.onAnimationFinish(!1),this.animation.oncancel=()=>this.isClosing=!1}open(){this.el.style.height=`${this.el.offsetHeight}px`,this.el.open=!0,window.requestAnimationFrame(()=>this.expand())}expand(){this.isExpanding=!0;const startHeight=`${this.el.offsetHeight}px`,endHeight=`${this.summary.offsetHeight+this.content.offsetHeight+20}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[startHeight,endHeight]},{duration:300,easing:"ease-out"}),this.animation.onfinish=()=>this.onAnimationFinish(!0),this.animation.oncancel=()=>this.isExpanding=!1}onAnimationFinish(open){this.el.open=open,this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.el.style.height=this.el.style.overflow=""}}async function getTreeFinderData(){treeFinderData=await fetch("/public/trees.json").then(response=>response.json()).then(data=>data).catch(error=>{})}async function populatePage(treeFinderStart,treeFinderEnd,trees,treeFilter=[],firstLoad=!0){let add=!1,treeDataSubset=[];if(treeFilter.length>0){if(filteredData=trees.filter(tree=>{let compareValue="";if(""!==tree.uses&&void 0!==tree.uses&&(compareValue+=`${tree.uses}`),""!==tree.tolerates&&void 0!==tree.tolerates&&(compareValue+=`${tree.tolerates}`),""!==tree.winterFoliage&&void 0!==tree.winterFoliage&&(compareValue+=`${tree.winterFoliage}`),""!==tree.origin&&void 0!==tree.origin&&(compareValue+=`${tree.origin}`),""!==tree.soilType&&void 0!==tree.soilType&&(compareValue+=`${tree.soilType}`),""!==tree.sunShade&&void 0!==tree.sunShade&&(compareValue+=`${tree.sunShade}`),""!==tree.types&&void 0!==tree.types&&(compareValue+=`${tree.types}`),""!==tree.height&&void 0!==tree.height){let compareArray;tree.height.split(", ").forEach(value=>{compareValue+=`${value}-h`})}if(""!==tree.width&&void 0!==tree.width){let compareArray;tree.width.split(", ").forEach(value=>{compareValue+=`${value}-w`})}""!==tree.flowers&&void 0!==tree.flowers&&(""!==tree.flowers.summer&&(compareValue+="summer-fls",tree.flowers.summer.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.autumn&&(compareValue+="autumn-fls",tree.flowers.autumn.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.winter&&(compareValue+="winter-fls",tree.flowers.winter.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.spring&&(compareValue+="spring-fls",tree.flowers.spring.split(", ").forEach(color=>{compareValue+=`${color}-fc`}))),""!==tree.foliage&&void 0!==tree.foliage&&(""!==tree.foliage.summer&&tree.foliage.summer.split(", ").forEach(color=>{compareValue+=`${color}-flc`}),""!==tree.foliage.autumn&&tree.foliage.autumn.split(", ").forEach(color=>{compareValue+=`${color}-ac`}),""!==tree.foliage.winter&&tree.foliage.winter.split(", ").forEach(color=>{compareValue+=`${color}-flc`}),""!==tree.foliage.spring&&tree.foliage.spring.split(", ").forEach(color=>{compareValue+=`${color}-flc`})),""!==tree.fruit&&void 0!==tree.fruit&&(""!==tree.fruit.summer&&(compareValue+="summer-fs"),""!==tree.fruit.autumn&&(compareValue+="autumn-fs"),""!==tree.fruit.winter&&(compareValue+="winter-fs"),""!==tree.fruit.spring&&(compareValue+="spring-fs"));let heightFound=!1,widthFound=!1;for(let i=0;i<treeFilter.length;i++){if(-1!==treeFilter[i].search("-h"))for(let j=0;j<heightsArray.length;j++){if(-1!==compareValue.search(heightsArray[j])){heightFound=!0;break}heightFound=!1,j===heightsArray.length-1&&(heightFound=!1)}else if(-1!==treeFilter[i].search("-w"))for(let j=0;j<widthsArray.length;j++){if(-1!==compareValue.search(widthsArray[j])){widthFound=!0;break}widthFound=!1,j===widthsArray.length-1&&(widthFound=!1)}else{if(-1===compareValue.search(treeFilter[i])){add=!1;break}add=!0}heightsArray.length>0&&widthsArray.length>0?add=!(!heightFound||!widthFound):heightsArray.length>0?add=!!heightFound:widthsArray.length>0&&(add=!!widthFound)}return add}),0!==filteredData.length){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>filteredData.length-1);i++)treeDataSubset.push(filteredData[i]);treeFinderEnd>=filteredData.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}}else if(0!==trees.length){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>trees.length-1);i++)treeDataSubset.push(trees[i]);treeFinderEnd>=trees.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}if(0===treeDataSubset.length){let noProducts=document.createElement("p");noProducts.id="no-products",noProducts.classList.add("paragraph-title"),buttonDiv.style.setProperty("opacity","0"),treeWrapper.innerHTML="",noProducts.textContent="No trees found. Try different filter options.",treeWrapper.insertAdjacentElement("afterbegin",noProducts),loadMoreButton.disabled=!0,returnToTopButton.disabled=!0}else{returnToTopButton.disabled=!1,buttonDiv.style.setProperty("opacity","1");for(let i=0;i<treeDataSubset.length;i++)if(void 0!==treeDataSubset[i]&&null!==treeDataSubset[i]){let treeItem=document.createElement("div");treeItem.classList.add("tree-item");let treeUrl=document.createElement("a");treeUrl.href=`/trees/${treeDataSubset[i].url}/`,treeUrl.textContent="View Tree",treeUrl.classList.add("tree-link"),treeUrl.classList.add("button");let treeTitle=document.createElement("h2"),treeSubtitle=document.createElement("h3"),container=document.createElement("div");container.classList.add("title-link-box");let titleContainer=document.createElement("div");titleContainer.classList.add("title-container"),""!==treeDataSubset[i].cultivar?""!==treeDataSubset[i].form?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> f. <i>${treeDataSubset[i].form}</i> '${treeDataSubset[i].cultivar}'`:""!==treeDataSubset[i].variety?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> var. <i>${treeDataSubset[i].variety}</i> '${treeDataSubset[i].cultivar}'`:""!==treeDataSubset[i].subspecies?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> subsp. <i>${treeDataSubset[i].subspecies}</i> '${treeDataSubset[i].cultivar}'`:""!==treeDataSubset[i].hybrid?-1!==treeDataSubset[i].hybrid.search(" x ")?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].hybrid}</i> '${treeDataSubset[i].cultivar}'`:treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> x <i>${treeDataSubset[i].hybrid}</i> '${treeDataSubset[i].cultivar}'`:""!==treeDataSubset[i].species?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> '${treeDataSubset[i].cultivar}'`:treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> '${treeDataSubset[i].cultivar}'`:""!==treeDataSubset[i].form?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> f. <i>${treeDataSubset[i].form}</i>`:""!==treeDataSubset[i].variety?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> var. <i>${treeDataSubset[i].variety}</i>`:""!==treeDataSubset[i].subspecies?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i> subsp. <i>${treeDataSubset[i].subspecies}</i>`:""!==treeDataSubset[i].hybrid?-1!==treeDataSubset[i].hybrid.search(" x ")?treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].hybrid}</i>`:treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> x <i>${treeDataSubset[i].hybrid}</i>`:treeTitle.innerHTML=`<i>${treeDataSubset[i].genus}</i> <i>${treeDataSubset[i].species}</i>`,treeSubtitle.textContent=`${treeDataSubset[i].commonName}`,titleContainer.appendChild(treeTitle),titleContainer.appendChild(treeSubtitle),container.appendChild(titleContainer),container.appendChild(treeUrl);let imageDiv=document.createElement("div");imageDiv.classList.add("tree-image");let treeImage=document.createElement("img");treeImage.src=`https://leafland.imgix.net/images/trees/${treeDataSubset[i].mainImage}?auto=format&w=500&q=75`,treeImage.width="500",treeImage.height="500",treeImage.alt=treeDataSubset[i].url.replace(/-/g," "),imageDiv.appendChild(treeImage),treeItem.appendChild(imageDiv),treeItem.appendChild(container),!1===firstLoad?(treeItem.style.setProperty("--animation-order",`${i%12}`),treeItem.classList.add("tree-item-loaded")):(treeItem.style.setProperty("visibility","visible"),treeItem.style.setProperty("opacity","1")),treeWrapper.appendChild(treeItem)}}}function resetStartEnd(){treeFinderStart=0,treeFinderEnd=11}window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("details").forEach(element=>{new Accordion(element)})}),async function(){await getTreeFinderData(),filterSettings.uses.forEach(value=>{treeFilter.push(value)}),filterSettings.tolerates.forEach(value=>{treeFilter.push(value)}),filterSettings.types.forEach(value=>{treeFilter.push(value)}),filterSettings.winterFoliage.forEach(value=>{treeFilter.push(value)}),filterSettings.origin.forEach(value=>{treeFilter.push(value)}),filterSettings.soilType.forEach(value=>{treeFilter.push(value)}),filterSettings.sunAndShade.forEach(value=>{treeFilter.push(value)}),filterSettings.height.forEach(value=>{treeFilter.push(value),heightsArray.push(value)}),filterSettings.width.forEach(value=>{treeFilter.push(value),widthsArray.push(value)}),filterSettings.fruitingSeason.forEach(value=>{treeFilter.push(value)}),filterSettings.floweringSeason.forEach(value=>{treeFilter.push(value)}),filterSettings.flowerColour.forEach(value=>{treeFilter.push(value)}),filterSettings.autumnColour.forEach(value=>{treeFilter.push(value)}),filterSettings.foliageColour.forEach(value=>{treeFilter.push(value)}),treeFilter.length>0&&(history.scrollRestoration&&(history.scrollRestoration="manual"),treeWrapper.innerHTML="",await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!0))}(),document.querySelector("select").addEventListener("input",event=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd(),filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]};let selectData=Array.from(event.target.selectedOptions).reduce((data,opt)=>(data.push(opt.value),filterSettings[`${opt.dataset.category}`].includes(opt.value)||(filterSettings[`${opt.dataset.category}`].push(opt.value),filterSettings.empty=!1),-1!==opt.value.search("-h")?heightsArray.push(opt.value):-1!==opt.value.search("-w")&&widthsArray.push(opt.value),data),[]);selectData.length>0?!0===clearSelectFilter.disabled&&(clearSelectFilter.disabled=!1):clearSelectFilter.disabled=!0;let filterValue=selectData.join(",");treeFilter=filterValue.split(","),treeWrapper.innerHTML="",sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!1)}(),treeWrapper.style.setProperty("opacity","1")}),inputsArray.forEach(input=>{input.addEventListener("input",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd(),filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},document.querySelector("#uses").textContent="0",document.querySelector("#tolerates").textContent="0",document.querySelector("#types").textContent="0",document.querySelector("#winterFoliage").textContent="0",document.querySelector("#origin").textContent="0",document.querySelector("#soilType").textContent="0",document.querySelector("#sunAndShade").textContent="0",document.querySelector("#height").textContent="0",document.querySelector("#width").textContent="0",document.querySelector("#fruitingSeason").textContent="0",document.querySelector("#floweringSeason").textContent="0",document.querySelector("#flowerColour").textContent="0",document.querySelector("#autumnColour").textContent="0",document.querySelector("#foliageColour").textContent="0",inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(treeFilter.push(filterInput.value),filterSettings[`${filterInput.dataset.category}`].includes(filterInput.value)||(filterSettings[`${filterInput.dataset.category}`].push(filterInput.value),filterSettings.empty=!1),-1!==filterInput.value.search("-h")?heightsArray.push(filterInput.value):-1!==filterInput.value.search("-w")&&widthsArray.push(filterInput.value),document.querySelector(`#${filterInput.dataset.category}`).textContent=parseInt(document.querySelector(`#${filterInput.dataset.category}`).textContent)+1)}),treeFilter.length>0?!0===clearCheckboxFilter.disabled&&(clearCheckboxFilter.disabled=!1):clearCheckboxFilter.disabled=!0,treeWrapper.innerHTML="",sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!1)}(),treeWrapper.style.setProperty("opacity","1")})}),clearCheckboxFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(filterInput.checked=!1)}),clearCheckboxFilter.disabled=!0,document.querySelector("#uses").textContent="0",document.querySelector("#tolerates").textContent="0",document.querySelector("#types").textContent="0",document.querySelector("#winterFoliage").textContent="0",document.querySelector("#origin").textContent="0",document.querySelector("#soilType").textContent="0",document.querySelector("#sunAndShade").textContent="0",document.querySelector("#height").textContent="0",document.querySelector("#width").textContent="0",document.querySelector("#fruitingSeason").textContent="0",document.querySelector("#floweringSeason").textContent="0",document.querySelector("#flowerColour").textContent="0",document.querySelector("#autumnColour").textContent="0",document.querySelector("#foliageColour").textContent="0",filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!1)}(),treeWrapper.style.setProperty("opacity","1")}),clearSelectFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[];let options=document.querySelectorAll("select");for(let i=0;i<options.length;i++)options[i].selected=!1,options[i].value="";clearSelectFilter.disabled=!0,filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!1)}(),treeWrapper.style.setProperty("opacity","1")}),loadMoreButton.addEventListener("click",()=>{treeFinderStart+=12,treeFinderEnd+=12,async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter,!1)}()}),returnToTopButton.addEventListener("click",()=>{window.scroll({top:0,left:0})});