let treeWrapper=document.querySelector("#tree-wrapper"),content=document.querySelector("#content"),clearCheckboxFilter=document.querySelector("#clear-checkbox-filter"),clearSelectFilter=document.querySelector("#clear-select-filter"),treeFinderStart=0,treeFinderEnd=11,imageDataSubset=[],inputsArray=document.querySelectorAll("input"),treeFilter=[],heightsArray=[],widthsArray=[],treeFinderData=[],treeFinderImages=[],buttonDiv=document.querySelector("#button-div"),loadMoreButton=document.querySelector("#load-more"),returnToTopButton=document.querySelector("#return-to-top"),filteredData=[];class Accordion{constructor(el){this.el=el,this.summary=el.querySelector("summary"),this.content=el.querySelector(".options-group"),this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.summary.addEventListener("click",e=>this.onClick(e))}onClick(e){e.preventDefault(),this.el.style.overflow="hidden",this.isClosing||!this.el.open?this.open():(this.isExpanding||this.el.open)&&this.shrink()}shrink(){this.isClosing=!0;const startHeight=`${this.el.offsetHeight}px`,endHeight=`${this.summary.offsetHeight}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[startHeight,endHeight]},{duration:300,easing:"ease-out"}),this.animation.onfinish=()=>this.onAnimationFinish(!1),this.animation.oncancel=()=>this.isClosing=!1}open(){this.el.style.height=`${this.el.offsetHeight}px`,this.el.open=!0,window.requestAnimationFrame(()=>this.expand())}expand(){this.isExpanding=!0;const startHeight=`${this.el.offsetHeight}px`,endHeight=`${this.summary.offsetHeight+this.content.offsetHeight+20}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[startHeight,endHeight]},{duration:300,easing:"ease-out"}),this.animation.onfinish=()=>this.onAnimationFinish(!0),this.animation.oncancel=()=>this.isExpanding=!1}onAnimationFinish(open){this.el.open=open,this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.el.style.height=this.el.style.overflow=""}}async function getTreeFinderData(){treeFinderData=await fetch("https://api.leafland.co.nz/default/get-product-data?type=tree-finder",{method:"GET"}).then(response=>response.json()).then(data=>data).catch(error=>{})}async function getTreeFinderImages(){treeFinderImages=await fetch("https://api.leafland.co.nz/default/get-image-data").then(response=>response.json()).then(data=>data).catch(error=>{})}async function populatePage(treeFinderStart,treeFinderEnd,trees,treeFilter=[]){let add=!1,treeDataSubset=[];if(treeFilter.length>0){if(filteredData=trees.filter(tree=>{let compareValue="";if(""!==tree.uses&&void 0!==tree.uses&&(compareValue+=`${tree.uses}`),""!==tree.tolerates&&void 0!==tree.tolerates&&(compareValue+=`${tree.tolerates}`),""!==tree.winterFoliage&&void 0!==tree.winterFoliage&&(compareValue+=`${tree.winterFoliage}`),""!==tree.origin&&void 0!==tree.origin&&(compareValue+=`${tree.origin}`),""!==tree.soilType&&void 0!==tree.soilType&&(compareValue+=`${tree.soilType}`),""!==tree.sunShade&&void 0!==tree.sunShade&&(compareValue+=`${tree.sunShade}`),""!==tree.types&&void 0!==tree.types&&(compareValue+=`${tree.types}`),""!==tree.height&&void 0!==tree.height){let compareArray;tree.height.split(", ").forEach(value=>{compareValue+=`${value}-h`})}if(""!==tree.width&&void 0!==tree.width){let compareArray;tree.width.split(", ").forEach(value=>{compareValue+=`${value}-w`})}if(""!==tree.floweringSeason&&void 0!==tree.floweringSeason){let compareArray;tree.floweringSeason.split(", ").forEach(value=>{compareValue+=`${value}-fls`})}if(""!==tree.flowerColor&&void 0!==tree.flowerColor){let compareArray;tree.flowerColor.split(", ").forEach(value=>{compareValue+=`${value}-fc`})}if(""!==tree.autumnColor&&void 0!==tree.autumnColor){let compareArray;tree.autumnColor.split(", ").forEach(value=>{compareValue+=`${value}-ac`})}if(""!==tree.foliageColor&&void 0!==tree.foliageColor){let compareArray;tree.foliageColor.split(", ").forEach(value=>{compareValue+=`${value}-flc`})}if(""!==tree.fruitingSeason&&void 0!==tree.fruitingSeason){let compareArray;tree.fruitingSeason.split(", ").forEach(value=>{compareValue+=`${value}-fs`})}let heightFound=!1,widthFound=!1;for(let i=0;i<treeFilter.length;i++){if(-1!==treeFilter[i].search("-h"))for(let j=0;j<heightsArray.length;j++){if(-1!==compareValue.search(heightsArray[j])){heightFound=!0;break}heightFound=!1,j===heightsArray.length-1&&(heightFound=!1)}else if(-1!==treeFilter[i].search("-w"))for(let j=0;j<widthsArray.length;j++){if(-1!==compareValue.search(widthsArray[j])){widthFound=!0;break}widthFound=!1,j===widthsArray.length-1&&(widthFound=!1)}else{if(-1===compareValue.search(treeFilter[i])){add=!1;break}add=!0}heightsArray.length>0&&widthsArray.length>0?add=!(!heightFound||!widthFound):heightsArray.length>0?add=!!heightFound:widthsArray.length>0&&(add=!!widthFound)}return add}),0!==filteredData.length){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>filteredData.length-1);i++)treeDataSubset.push(filteredData[i]);treeFinderEnd>=filteredData.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}}else if(0!==trees.length){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>trees.length-1);i++)treeDataSubset.push(trees[i]);treeFinderEnd>=trees.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}if(0===treeDataSubset.length){let noProducts=document.createElement("p");noProducts.id="no-products",noProducts.classList.add("paragraph-title"),buttonDiv.style.setProperty("opacity","0"),treeWrapper.innerHTML="",noProducts.textContent="No trees found. Try a different filter query.",treeWrapper.insertAdjacentElement("afterbegin",noProducts),loadMoreButton.disabled=!0,returnToTopButton.disabled=!0}else{returnToTopButton.disabled=!1,buttonDiv.style.setProperty("opacity","1");for(let i=0;i<treeDataSubset.length;i++)if(void 0!==treeDataSubset[i]&&null!==treeDataSubset[i]){let treeItem=document.createElement("div");treeItem.classList.add("tree-item");let treeUrl=document.createElement("a");treeUrl.href=`/trees/${treeDataSubset[i].url}/`,treeUrl.textContent="View Tree",treeUrl.classList.add("tree-link"),treeUrl.classList.add("button");let treeTitle=document.createElement("h2"),treeSubtitle=document.createElement("h3"),container=document.createElement("div");container.classList.add("title-link-box");let titleContainer=document.createElement("div");titleContainer.classList.add("title-container"),treeTitle.textContent=treeDataSubset[i].botanicalName,""!==treeDataSubset[i].commonName?(treeSubtitle.textContent=`${treeDataSubset[i].commonName}`,titleContainer.appendChild(treeTitle),titleContainer.appendChild(treeSubtitle)):titleContainer.appendChild(treeTitle),container.appendChild(titleContainer),container.appendChild(treeUrl);let imageDiv=document.createElement("div");if(imageDiv.classList.add("tree-image"),treeFinderImages.length>0){imageDataSubset=[];for(let j=0;j<treeFinderImages.length;j++)if(treeFinderImages[j].split("/",4)[3]===`${treeDataSubset[i].url}.jpg`||treeFinderImages[j].split("/",4)[3]===`${treeDataSubset[i].url}.jpeg`){imageDataSubset.push(treeFinderImages[j]);break}if(imageDataSubset.length>0){let treeImage=document.createElement("img");treeImage.src=`https://ik.imagekit.io/leafland/${imageDataSubset[imageDataSubset.length-1]}?tr=w-500,q-75,pr-true,f-auto`,treeImage.width="500",treeImage.height="500",treeImage.alt=imageDataSubset[imageDataSubset.length-1].substring(imageDataSubset[imageDataSubset.length-1].lastIndexOf("/")+1,imageDataSubset[imageDataSubset.length-1].lastIndexOf(".")).replace(/-/g," "),treeImage.loading="lazy",imageDiv.appendChild(treeImage),treeItem.appendChild(imageDiv)}}treeItem.appendChild(container),treeItem.style.setProperty("--animation-order",`${i%12}`),treeItem.classList.add("tree-item-loaded"),treeWrapper.appendChild(treeItem)}}}function resetStartEnd(){treeFinderStart=0,treeFinderEnd=11}window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("details").forEach(element=>{new Accordion(element)})}),async function(){await getTreeFinderData(),await getTreeFinderImages(),0!==treeFinderData.length&&(await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter),buttonDiv.style.setProperty("opacity","1"),document.body.classList.add("page-loaded"))}(),document.querySelector("select").addEventListener("input",event=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd();let selectData=Array.from(event.target.selectedOptions).reduce((data,opt)=>(data.push(opt.value),-1!==opt.value.search("-h")?heightsArray.push(opt.value):-1!==opt.value.search("-w")&&widthsArray.push(opt.value),data),[]);selectData.length>0?!0===clearSelectFilter.disabled&&(clearSelectFilter.disabled=!1):clearSelectFilter.disabled=!0;let filterValue=selectData.join(",");treeFilter=filterValue.split(","),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),inputsArray.forEach(input=>{input.addEventListener("input",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd(),inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(treeFilter.push(filterInput.value),-1!==filterInput.value.search("-h")?heightsArray.push(filterInput.value):-1!==filterInput.value.search("-w")&&widthsArray.push(filterInput.value))}),treeFilter.length>0?!0===clearCheckboxFilter.disabled&&(clearCheckboxFilter.disabled=!1):clearCheckboxFilter.disabled=!0,treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")})}),clearCheckboxFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(filterInput.checked=!1)}),clearCheckboxFilter.disabled=!0,resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),clearSelectFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[];let options=document.querySelectorAll("select");for(let i=0;i<options.length;i++)options[i].selected=!1,options[i].value="";clearSelectFilter.disabled=!0,resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),loadMoreButton.addEventListener("click",()=>{treeFinderStart+=12,treeFinderEnd+=12,async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}()}),returnToTopButton.addEventListener("click",()=>{window.scroll({top:0,left:0})});