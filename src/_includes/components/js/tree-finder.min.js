async function getTreeFinderData(){treeFinderData=await fetch("https://api.leafland.co.nz/default/get-product-data?type=tree-finder",{method:"GET"}).then(e=>e.json()).then(e=>e).catch(e=>{})}async function getTreeFinderImages(){treeFinderImages=await fetch("https://api.leafland.co.nz/default/get-image-data").then(e=>e.json()).then(e=>e).catch(e=>{})}async function populatePage(e,t,r,i=[]){let a=!1,n=[];if(i.length>0){if(filteredData=r.filter(e=>{let t="";if(""!==e.uses&&void 0!==e.uses){let r=e.uses.split(", ");r.forEach(e=>{t+=`${e}`})}if(""!==e.tolerates&&void 0!==e.tolerates){let r=e.tolerates.split(", ");r.forEach(e=>{t+=`${e}`})}if(""!==e.winterFoliage&&void 0!==e.winterFoliage){let r=e.winterFoliage.split(", ");r.forEach(e=>{t+=`${e}`})}if(""!==e.origin&&void 0!==e.origin){let r=e.origin.split(", ");r.forEach(e=>{t+=`${e}`})}if(""!==e.types&&void 0!==e.types){let r=e.types.split(", ");r.forEach(e=>{t+=`${e}`})}if(""!==e.height&&void 0!==e.height){let r=e.height.split(", ");r.forEach(e=>{t+=`${e}-h`})}if(""!==e.width&&void 0!==e.width){let r=e.width.split(", ");r.forEach(e=>{t+=`${e}-w`})}if(""!==e.floweringSeason&&void 0!==e.floweringSeason){let r=e.floweringSeason.split(", ");r.forEach(e=>{t+=`${e}-fls`})}if(""!==e.flowerColor&&void 0!==e.flowerColor){let r=e.flowerColor.split(", ");r.forEach(e=>{t+=`${e}-fc`})}if(""!==e.autumnColor&&void 0!==e.autumnColor){let r=e.autumnColor.split(", ");r.forEach(e=>{t+=`${e}-ac`})}if(""!==e.foliageColor&&void 0!==e.foliageColor){let r=e.foliageColor.split(", ");r.forEach(e=>{t+=`${e}-flc`})}if(""!==e.fruitingSeason&&void 0!==e.fruitingSeason){let r=e.fruitingSeason.split(", ");r.forEach(e=>{t+=`${e}-fs`})}let r=!1,n=!1;for(let e=0;e<i.length;e++){if(-1!==i[e].search("-h"))for(let e=0;e<heightsArray.length;e++){if(-1!==t.search(heightsArray[e])){r=!0;break}r=!1,e===heightsArray.length-1&&(r=!1)}else if(-1!==i[e].search("-w"))for(let e=0;e<widthsArray.length;e++){if(-1!==t.search(widthsArray[e])){n=!0;break}n=!1,e===widthsArray.length-1&&(n=!1)}else{if(-1===t.search(i[e])){a=!1;break}a=!0}heightsArray.length>0&&widthsArray.length>0?a=!(!r||!n):heightsArray.length>0?a=!!r:widthsArray.length>0&&(a=!!n)}return a}),0!==filteredData.length){for(let r=e;r<t+1&&!(r>filteredData.length-1);r++)n.push(filteredData[r]);t>=filteredData.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}}else if(0!==r.length){for(let i=e;i<t+1&&!(i>r.length-1);i++)n.push(r[i]);t>=r.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}if(0===n.length){let e=document.createElement("p");e.id="no-products",e.classList.add("paragraph-title"),buttonDiv.style.setProperty("opacity","0"),treeWrapper.innerHTML="",e.textContent="No trees found. Try a different filter query.",treeWrapper.insertAdjacentElement("afterbegin",e),loadMoreButton.disabled=!0,returnToTopButton.disabled=!0}else{returnToTopButton.disabled=!1,buttonDiv.style.setProperty("opacity","1");for(let e=0;e<n.length;e++)if(void 0!==n[e]&&null!==n[e]){let t=document.createElement("div");t.classList.add("tree-item");let r=document.createElement("a");r.href=`/trees/${n[e].url}/`,r.textContent="View Tree",r.classList.add("tree-link"),r.classList.add("button");let i=document.createElement("h2"),a=document.createElement("h3"),l=document.createElement("div");l.classList.add("title-link-box");let s=document.createElement("div");s.classList.add("title-container"),i.textContent=n[e].botanicalName,""!==n[e].commonName?(a.textContent=`${n[e].commonName}`,s.appendChild(i),s.appendChild(a)):s.appendChild(i),l.appendChild(s),l.appendChild(r);let o=document.createElement("div");if(o.classList.add("tree-image"),treeFinderImages.length>0){imageDataSubset=[];for(let t=0;t<treeFinderImages.length;t++)if(treeFinderImages[t].split("/",4)[3]===`${n[e].url}.jpg`||treeFinderImages[t].split("/",4)[3]===`${n[e].url}.jpeg`){imageDataSubset.push(treeFinderImages[t]);break}if(imageDataSubset.length>0){let e=document.createElement("img");e.src=`https://ik.imagekit.io/leafland/${imageDataSubset[imageDataSubset.length-1]}?tr=w-500,q-75,pr-true,f-auto`,e.width="500",e.height="500",e.alt=imageDataSubset[imageDataSubset.length-1].substring(imageDataSubset[imageDataSubset.length-1].lastIndexOf("/")+1,imageDataSubset[imageDataSubset.length-1].lastIndexOf(".")).replace(/-/g," "),e.loading="lazy",o.appendChild(e),t.appendChild(o)}}t.appendChild(l),t.style.setProperty("--animation-order",`${e%12}`),t.classList.add("tree-item-loaded"),treeWrapper.appendChild(t)}}}function resetStartEnd(){treeFinderStart=0,treeFinderEnd=11}let treeWrapper=document.querySelector("#tree-wrapper"),content=document.querySelector("#content"),clearCheckboxFilter=document.querySelector("#clear-checkbox-filter"),clearSelectFilter=document.querySelector("#clear-select-filter"),treeFinderStart=0,treeFinderEnd=11,imageDataSubset=[],inputsArray=document.querySelectorAll("input"),treeFilter=[],heightsArray=[],widthsArray=[],treeFinderData=[],treeFinderImages=[],buttonDiv=document.querySelector("#button-div"),loadMoreButton=document.querySelector("#load-more"),returnToTopButton=document.querySelector("#return-to-top"),filteredData=[];class Accordion{constructor(e){this.el=e,this.summary=e.querySelector("summary"),this.content=e.querySelector(".options-group"),this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.summary.addEventListener("click",e=>this.onClick(e))}onClick(e){e.preventDefault(),this.el.style.overflow="hidden",this.isClosing||!this.el.open?this.open():(this.isExpanding||this.el.open)&&this.shrink()}shrink(){this.isClosing=!0;const e=`${this.el.offsetHeight}px`,t=`${this.summary.offsetHeight}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[e,t]},{duration:300,easing:"ease-out"}),this.animation.onfinish=(()=>this.onAnimationFinish(!1)),this.animation.oncancel=(()=>this.isClosing=!1)}open(){this.el.style.height=`${this.el.offsetHeight}px`,this.el.open=!0,window.requestAnimationFrame(()=>this.expand())}expand(){this.isExpanding=!0;const e=`${this.el.offsetHeight}px`,t=`${this.summary.offsetHeight+this.content.offsetHeight+20}px`;this.animation&&this.animation.cancel(),this.animation=this.el.animate({height:[e,t]},{duration:300,easing:"ease-out"}),this.animation.onfinish=(()=>this.onAnimationFinish(!0)),this.animation.oncancel=(()=>this.isExpanding=!1)}onAnimationFinish(e){this.el.open=e,this.animation=null,this.isClosing=!1,this.isExpanding=!1,this.el.style.height=this.el.style.overflow=""}}window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("details").forEach(e=>{new Accordion(e)})}),async function(){await getTreeFinderData(),await getTreeFinderImages(),0!==treeFinderData.length&&(await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter),buttonDiv.style.setProperty("opacity","1"),document.body.classList.add("page-loaded"))}(),document.querySelector("select").addEventListener("input",e=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd();let t=Array.from(e.target.selectedOptions).reduce((e,t)=>(e.push(t.value),-1!==t.value.search("-h")?heightsArray.push(t.value):-1!==t.value.search("-w")&&widthsArray.push(t.value),e),[]);t.length>0?!0===clearSelectFilter.disabled&&(clearSelectFilter.disabled=!1):clearSelectFilter.disabled=!0;let r=t.join(",");treeFilter=r.split(","),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),inputsArray.forEach(e=>{e.addEventListener("input",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd(),inputsArray.forEach(e=>{!0===e.checked&&(treeFilter.push(e.value),-1!==e.value.search("-h")?heightsArray.push(e.value):-1!==e.value.search("-w")&&widthsArray.push(e.value))}),treeFilter.length>0?!0===clearCheckboxFilter.disabled&&(clearCheckboxFilter.disabled=!1):clearCheckboxFilter.disabled=!0,treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")})}),clearCheckboxFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],inputsArray.forEach(e=>{!0===e.checked&&(e.checked=!1)}),clearCheckboxFilter.disabled=!0,resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),clearSelectFilter.addEventListener("click",()=>{treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[];let e=document.querySelectorAll("select");for(let t=0;t<e.length;t++)e[t].selected=!1,e[t].value="";clearSelectFilter.disabled=!0,resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),loadMoreButton.addEventListener("click",()=>{treeFinderStart+=12,treeFinderEnd+=12,async function(){await populatePage(treeFinderStart,treeFinderEnd,treeFinderData,treeFilter)}()}),returnToTopButton.addEventListener("click",()=>{window.scroll({top:0,left:0})});