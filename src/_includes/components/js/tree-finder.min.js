let treeWrapper=document.querySelector("#tree-wrapper"),content=document.querySelector("#content"),treeFinderStart=0,treeFinderEnd=23,imageDataSubset=[],inputsArray=document.querySelectorAll(".filter-input"),treeFilter=[],heightsArray=[],widthsArray=[],filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]};if(sessionStorage.getItem("filterSettings")&&(filterSettings=JSON.parse(sessionStorage.getItem("filterSettings"))),!1===filterSettings.empty)for(let i=0;i<inputsArray.length;i++)filterSettings[`${inputsArray[i].dataset.category}`].includes(inputsArray[i].value)?(inputsArray[i].checked=!0,inputsArray[i].parentNode.classList.add("option-selected")):inputsArray[i].checked=!1;let buttonDiv=document.querySelector("#button-div"),loadMoreButton=document.querySelector("#load-more"),returnToTopButton=document.querySelector("#return-to-top"),filteredData=[];function updateTreeFilter(){filterSettings.uses.forEach(value=>{treeFilter.push(value)}),filterSettings.tolerates.forEach(value=>{treeFilter.push(value)}),filterSettings.types.forEach(value=>{treeFilter.push(value)}),filterSettings.winterFoliage.forEach(value=>{treeFilter.push(value)}),filterSettings.origin.forEach(value=>{treeFilter.push(value)}),filterSettings.soilType.forEach(value=>{treeFilter.push(value)}),filterSettings.sunAndShade.forEach(value=>{treeFilter.push(value)}),filterSettings.height.forEach(value=>{treeFilter.push(value),heightsArray.push(value)}),filterSettings.width.forEach(value=>{treeFilter.push(value),widthsArray.push(value)}),filterSettings.fruitingSeason.forEach(value=>{treeFilter.push(value)}),filterSettings.floweringSeason.forEach(value=>{treeFilter.push(value)}),filterSettings.flowerColour.forEach(value=>{treeFilter.push(value)}),filterSettings.autumnColour.forEach(value=>{treeFilter.push(value)}),filterSettings.foliageColour.forEach(value=>{treeFilter.push(value)})}function createClearButton(filterInput){let clearFilter=document.createElement("button");clearFilter.dataset.value=filterInput.value,filterInput.value.includes("-fc")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Flowers</span> <span class='clear-button'></span>":filterInput.value.includes("-flc")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Foliage</span> <span class='clear-button'></span>":filterInput.value.includes("-ac")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Autumn Foliage</span> <span class='clear-button'></span>":filterInput.value.includes("-fs")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Fruiting</span> <span class='clear-button'></span>":filterInput.value.includes("-fls")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Flowering</span> <span class='clear-button'></span>":filterInput.value.includes("-h")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" High</span> <span class='clear-button'></span>":filterInput.value.includes("-w")?clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+" Wide</span> <span class='clear-button'></span>":clearFilter.innerHTML="<span class='clear-text'>"+document.querySelector(`label[for="${filterInput.value}"]`).textContent+"</span> <span class='clear-button'></span>",clearFilter.addEventListener("click",()=>{document.querySelector(`#${CSS.escape(clearFilter.dataset.value)}`).checked=!1,document.querySelector(`#${CSS.escape(clearFilter.dataset.value)}`).parentNode.classList.remove("option-selected"),clearFilter.style.setProperty("display","none"),treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]};for(let i=0;i<inputsArray.length;i++)!0===inputsArray[i].checked&&(filterSettings[`${inputsArray[i].dataset.category}`].push(inputsArray[i].value),filterSettings.empty=!1);!1===filterSettings.empty?updateTreeFilter():document.querySelector("#clear-filter-buttons").innerHTML="",sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),document.querySelector("#clear-filter-buttons").appendChild(clearFilter)}async function populatePage(treeFinderStart,treeFinderEnd,trees,treeFilter=[]){let add=!1,treeDataSubset=[];if(treeFilter.length>0){if(filteredData=trees.filter(tree=>{let compareValue="";if(""!==tree.uses&&void 0!==tree.uses&&(compareValue+=`${tree.uses}`),""!==tree.tolerates&&void 0!==tree.tolerates&&(compareValue+=`${tree.tolerates}`),""!==tree.winterFoliage&&void 0!==tree.winterFoliage&&(compareValue+=`${tree.winterFoliage}`),""!==tree.origin&&void 0!==tree.origin&&(compareValue+=`${tree.origin}`),""!==tree.soilType&&void 0!==tree.soilType&&(compareValue+=`${tree.soilType}`),""!==tree.sunShade&&void 0!==tree.sunShade&&(compareValue+=`${tree.sunShade}`),""!==tree.types&&void 0!==tree.types&&(compareValue+=`${tree.types}`),""!==tree.height&&void 0!==tree.height){let compareArray;tree.height.split(", ").forEach(value=>{compareValue+=`${value}-h`})}if(""!==tree.width&&void 0!==tree.width){let compareArray;tree.width.split(", ").forEach(value=>{compareValue+=`${value}-w`})}""!==tree.flowers&&void 0!==tree.flowers&&(""!==tree.flowers.summer&&(compareValue+="summer-fls",tree.flowers.summer.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.autumn&&(compareValue+="autumn-fls",tree.flowers.autumn.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.winter&&(compareValue+="winter-fls",tree.flowers.winter.split(", ").forEach(color=>{compareValue+=`${color}-fc`})),""!==tree.flowers.spring&&(compareValue+="spring-fls",tree.flowers.spring.split(", ").forEach(color=>{compareValue+=`${color}-fc`}))),""!==tree.foliage&&void 0!==tree.foliage&&(""!==tree.foliage.summer&&tree.foliage.summer.split(", ").forEach(color=>{compareValue+=`${color}-flc`}),""!==tree.foliage.autumn&&tree.foliage.autumn.split(", ").forEach(color=>{compareValue+=`${color}-ac`}),""!==tree.foliage.winter&&tree.foliage.winter.split(", ").forEach(color=>{compareValue+=`${color}-flc`}),""!==tree.foliage.spring&&tree.foliage.spring.split(", ").forEach(color=>{compareValue+=`${color}-flc`})),""!==tree.fruit&&void 0!==tree.fruit&&(""!==tree.fruit.summer&&(compareValue+="summer-fs"),""!==tree.fruit.autumn&&(compareValue+="autumn-fs"),""!==tree.fruit.winter&&(compareValue+="winter-fs"),""!==tree.fruit.spring&&(compareValue+="spring-fs"));let heightFound=!1,widthFound=!1;for(let i=0;i<treeFilter.length;i++){if(-1!==treeFilter[i].search("-h"))for(let j=0;j<heightsArray.length;j++){if(-1!==compareValue.search(heightsArray[j])){heightFound=!0;break}heightFound=!1,j===heightsArray.length-1&&(heightFound=!1)}else if(-1!==treeFilter[i].search("-w"))for(let j=0;j<widthsArray.length;j++){if(-1!==compareValue.search(widthsArray[j])){widthFound=!0;break}widthFound=!1,j===widthsArray.length-1&&(widthFound=!1)}else{if(-1===compareValue.search(treeFilter[i])){add=!1;break}add=!0}heightsArray.length>0&&widthsArray.length>0?add=!(!heightFound||!widthFound):heightsArray.length>0?add=!!heightFound:widthsArray.length>0&&(add=!!widthFound)}return add}),0!==filteredData.length){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>filteredData.length-1);i++)treeDataSubset.push(filteredData[i]);treeFinderEnd>=filteredData.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}}else if(trees.length>0){for(let i=treeFinderStart;i<treeFinderEnd+1&&!(i>trees.length-1);i++)treeDataSubset.push(trees[i]);treeFinderEnd>=trees.length-1?loadMoreButton.disabled=!0:loadMoreButton.disabled=!1}if(0===treeDataSubset.length){let noProducts=document.createElement("p");noProducts.id="no-products",noProducts.classList.add("paragraph-title"),buttonDiv.style.setProperty("opacity","0"),treeWrapper.innerHTML="",noProducts.textContent="No trees found. Try different filter options.",treeWrapper.insertAdjacentElement("afterbegin",noProducts),loadMoreButton.disabled=!0,returnToTopButton.disabled=!0}else{returnToTopButton.disabled=!1,buttonDiv.style.setProperty("opacity","1");for(let i=0;i<treeDataSubset.length;i++)if(void 0!==treeDataSubset[i]&&null!==treeDataSubset[i]){let treeUrl=document.createElement("a");treeUrl.href=`/trees/${treeDataSubset[i].url}/`,treeUrl.classList.add("tree-item");let treeTitle=document.createElement("h2"),treeSubtitle=document.createElement("h3"),titleContainer=document.createElement("div");titleContainer.classList.add("title-container"),treeTitle.innerHTML=`${treeDataSubset[i].fullName}`,treeSubtitle.textContent=`${treeDataSubset[i].commonName}`,titleContainer.appendChild(treeTitle),titleContainer.appendChild(treeSubtitle);let treeImage=document.createElement("img");treeImage.src=`https://img.imageboss.me/leafland/width/150/quality:75,format:auto/${treeDataSubset[i].images[0].split("&")[0]}`,treeImage.width="150",treeImage.height="150",treeImage.loading="lazy",treeImage.alt=treeDataSubset[i].url.replace(/-/g," "),treeUrl.appendChild(treeImage),treeUrl.appendChild(titleContainer),treeWrapper.appendChild(treeUrl)}}}function resetStartEnd(){treeFinderStart=0,treeFinderEnd=23}!async function(){if(updateTreeFilter(),treeFilter.length>0){history.scrollRestoration&&(history.scrollRestoration="manual"),window.addEventListener("dataLoaded",async()=>{await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)}),inputsArray.forEach(filterInput=>{!0===filterInput.checked&&createClearButton(filterInput)});let clearAll=document.createElement("button");clearAll.id="clear-all",clearAll.innerHTML="<span class='clear-text'>Clear All Filters</span> <span class='clear-button'></span>",clearAll.addEventListener("click",()=>{document.querySelector("#clear-filter-buttons").innerHTML="",treeWrapper.style.setProperty("opacity","0"),filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(filterInput.checked=!1,filterInput.parentNode.classList.remove("option-selected"))}),filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)}(),treeWrapper.style.setProperty("opacity","1")}),document.querySelector("#clear-filter-buttons").appendChild(clearAll)}else window.addEventListener("dataLoaded",async()=>{await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)})}(),loadMoreButton.addEventListener("click",()=>{treeFinderStart+=24,treeFinderEnd+=24,async function(){await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)}()}),returnToTopButton.addEventListener("click",()=>{window.scroll({top:0,left:0})}),document.querySelectorAll(".options-group-option").forEach(option=>{option.addEventListener("click",()=>{!0===option.querySelector(".filter-input").checked?(option.querySelector(".filter-input").checked=!1,option.classList.remove("option-selected")):(option.querySelector(".filter-input").checked=!0,option.classList.add("option-selected"))})}),document.body.querySelector("#open-filter").addEventListener("click",()=>{document.body.classList.add("filter-open")}),document.body.querySelector("#close-filter").addEventListener("click",()=>{filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],resetStartEnd(),filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},document.querySelector("#clear-filter-buttons").innerHTML="",inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(treeFilter.push(filterInput.value),filterSettings[`${filterInput.dataset.category}`].includes(filterInput.value)||(filterSettings[`${filterInput.dataset.category}`].push(filterInput.value),filterSettings.empty=!1),-1!==filterInput.value.search("-h")?heightsArray.push(filterInput.value):-1!==filterInput.value.search("-w")&&widthsArray.push(filterInput.value),createClearButton(filterInput))}),treeWrapper.innerHTML="",sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),async function(){if(await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter),treeFilter.length>0){let clearAll=document.createElement("button");clearAll.id="clear-all",clearAll.innerHTML="<span class='clear-text'>Clear All Filters</span> <span class='clear-button'></span>",clearAll.addEventListener("click",()=>{document.querySelector("#clear-filter-buttons").innerHTML="",filteredData=[],treeFilter=[],heightsArray=[],widthsArray=[],inputsArray.forEach(filterInput=>{!0===filterInput.checked&&(filterInput.checked=!1,filterInput.parentNode.classList.remove("option-selected"))}),filterSettings={empty:!0,uses:[],tolerates:[],types:[],winterFoliage:[],origin:[],soilType:[],sunAndShade:[],height:[],width:[],fruitingSeason:[],floweringSeason:[],flowerColour:[],autumnColour:[],foliageColour:[]},sessionStorage.setItem("filterSettings",JSON.stringify(filterSettings)),resetStartEnd(),treeWrapper.innerHTML="",async function(){await populatePage(treeFinderStart,treeFinderEnd,treeData,treeFilter)}()}),document.querySelector("#clear-filter-buttons").appendChild(clearAll)}}(),document.body.classList.remove("filter-open")});