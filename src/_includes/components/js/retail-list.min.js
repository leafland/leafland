let retailSearchInput=document.querySelector(".search"),nextButton=document.querySelector("#next"),prevButton=document.querySelector("#prev"),resultTotals=document.querySelector("#result-totals"),stockDataDiv=document.querySelector("#stock-data"),hideOutOfStock=document.querySelector("#hide-out-of-stock"),filterEdible=document.querySelector("#filter-edible"),filterNative=document.querySelector("#filter-native");var stockData=[];let filteredData=[],retailStart=0,retailEnd=24,heading=["BOTANICAL NAME","COMMON NAME","GRADE","$R","HEIGHT (m)","STANDARD (m)","READY","COMING ON"];async function displayData(dataSet,retailStart,retailEnd){if(dataSet.length<1)stockDataDiv.innerHTML='<h2 class="message">No results found</h2>',resultTotals.innerHTML="Showing 0 to 0 of 0 results",nextButton.disabled=!0,prevButton.disabled=!0;else{stockDataDiv.innerHTML="";let table=document.createElement("table");for(let i=retailStart;i<retailEnd+1&&!(i>dataSet.length-1);i++){if(i===retailStart){let row=document.createElement("tr");heading.forEach(item=>{let cell=document.createElement("th");cell.textContent=item,row.appendChild(cell)}),table.appendChild(row)}let row=document.createElement("tr");for(let j=0;j<10;j++)if(4!==j&&5!==j){let cell=document.createElement("td");cell.textContent=dataSet[i][j],row.appendChild(cell)}table.appendChild(row)}stockDataDiv.appendChild(table),resultTotals.innerHTML=`Showing ${retailStart+1} to ${retailEnd>dataSet.length?dataSet.length:retailEnd+1} of ${dataSet.length} results`}prevButton.disabled=0===retailStart,0!==dataSet.length&&(retailEnd>=dataSet.length-1?nextButton.disabled=!0:nextButton.disabled=!1)}function searchRetailData(input){input.length>0&&(filteredData.length>0?filteredData=filteredData.filter(data=>null!=data[0]&&!(!data[0].toLowerCase().includes(input.toLowerCase())&&!data[1].toLowerCase().includes(input.toLowerCase()))):stockData.forEach(data=>{null!=data[0]&&(data[0].toLowerCase().includes(input.toLowerCase())||data[1].toLowerCase().includes(input.toLowerCase()))&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd))}function resetStartEnd(){retailStart=0,retailEnd=24}function filterData(){filteredData=[],!0===hideOutOfStock.checked?!0===filterNative.checked&&!0===filterEdible.checked?(stockData.forEach(data=>{(parseInt(data[8])>0||parseInt(data[9])>0)&&void 0!==data[11]&&-1!==data[11].toLowerCase().search("edible")&&-1!==data[11].toLowerCase().search("native")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):!0===filterNative.checked?(stockData.forEach(data=>{(parseInt(data[8])>0||parseInt(data[9])>0)&&void 0!==data[11]&&-1!==data[11].toLowerCase().search("native")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):!0===filterEdible.checked?(stockData.forEach(data=>{(parseInt(data[8])>0||parseInt(data[9])>0)&&void 0!==data[11]&&-1!==data[11].toLowerCase().search("edible")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):(stockData.forEach(data=>{(parseInt(data[8])>0||parseInt(data[9])>0)&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):!0===filterNative.checked?!0===filterEdible.checked?(stockData.forEach(data=>{void 0!==data[11]&&-1!==data[11].toLowerCase().search("edible")&&-1!==data[11].toLowerCase().search("native")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):(stockData.forEach(data=>{void 0!==data[11]&&-1!==data[11].toLowerCase().search("native")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):!0===filterEdible.checked?!0===filterNative.checked?(stockData.forEach(data=>{void 0!==data[11]&&-1!==data[11].toLowerCase().search("edible")&&-1!==data[11].toLowerCase().search("native")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):(stockData.forEach(data=>{void 0!==data[11]&&-1!==data[11].toLowerCase().search("edible")&&filteredData.push(data)}),resetStartEnd(),displayData(filteredData,retailStart,retailEnd)):(resetStartEnd(),displayData(stockData,retailStart,retailEnd))}window.addEventListener("loginUpdated",()=>{!async function(){stockData=await fetch("https://api.leafland.co.nz/default/get-stock-data-file?type=list").then(response=>response.json()).catch(error=>{}),await displayData(stockData,retailStart,retailEnd),retailSearchInput.removeAttribute("disabled"),retailSearchInput.addEventListener("input",e=>{e.target.value.length<=0?filteredData.length>0?displayData(filteredData,retailStart,retailEnd):displayData(stockData,retailStart,retailEnd):searchRetailData(e.target.value)})}()}),nextButton.addEventListener("click",()=>{retailStart+=25,retailEnd+=25,filteredData.length>1?displayData(filteredData,retailStart,retailEnd):displayData(stockData,retailStart,retailEnd)}),prevButton.addEventListener("click",()=>{retailStart-=25,retailEnd-=25,(retailStart<0||retailEnd<0)&&resetStartEnd(),filteredData.length>1?displayData(filteredData,retailStart,retailEnd):displayData(stockData,retailStart,retailEnd)}),hideOutOfStock.addEventListener("input",()=>{filterData()}),filterEdible.addEventListener("input",()=>{filterData()}),filterNative.addEventListener("input",()=>{filterData()});