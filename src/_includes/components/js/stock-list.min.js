let stockSearchInput=document.querySelector(".search"),nextButton=document.querySelector("#next"),prevButton=document.querySelector("#prev"),resultTotals=document.querySelector("#result-totals"),stockDataDiv=document.querySelector("#stock-data"),hideOutOfStock=document.querySelector("#hide-out-of-stock"),filterEdible=document.querySelector("#filter-edible"),filterNative=document.querySelector("#filter-native"),filterDeciduous=document.querySelector("#filter-deciduous"),filterEvergreen=document.querySelector("#filter-evergreen"),filterSemiEvergreen=document.querySelector("#filter-semi-evergreen"),compareValue="",stockListType="";stockListType=-1===window.location.href.search("retail")?"wholesale":"retail";var stockData=[];let filteredData=[],stockStart=0,stockEnd=24,heading=[];async function displayData(dataSet,stockStart,stockEnd){if(dataSet.length<1)stockDataDiv.innerHTML='<p class="message">No results found.</p>',resultTotals.innerHTML="Showing 0 to 0 of 0 results",nextButton.disabled=!0,prevButton.disabled=!0;else{stockDataDiv.innerHTML="";let table=document.createElement("table");for(let i=stockStart;i<stockEnd+1&&!(i>dataSet.length-1);i++){if(i===stockStart){let row=document.createElement("tr");heading.forEach(item=>{let cell=document.createElement("th");cell.textContent=item,row.append(cell)}),table.append(row)}let row=document.createElement("tr");if("retail"===stockListType){for(let j=0;j<10;j++)if(4!==j&&5!==j){let cell=document.createElement("td");cell.textContent=dataSet[i][j],row.append(cell)}}else for(let j=0;j<10;j++)if(4!==j){let cell=document.createElement("td");cell.textContent=dataSet[i][j],row.append(cell)}table.append(row)}stockDataDiv.append(table),resultTotals.innerHTML=`Showing ${stockStart+1} to ${stockEnd>dataSet.length?dataSet.length:stockEnd+1} of ${dataSet.length} results`}prevButton.disabled=0===stockStart,0!==dataSet.length&&(stockEnd>=dataSet.length-1?nextButton.disabled=!0:nextButton.disabled=!1)}function resetStartEnd(){stockStart=0,stockEnd=24}function filterData(){filteredData=[];let compareArray=compareValue.split(","),hideFound=!1;if(compareArray.includes("hide")&&(compareArray=compareArray.filter(item=>"hide"!==item),hideFound=!0),compareArray.pop(),0===stockSearchInput.value.length&&0===compareArray.length&&!1===hideFound)resetStartEnd(),displayData(stockData,stockStart,stockEnd);else{if(0===stockSearchInput.value.length){for(let j=0;j<stockData.length;j++)for(let i=0;i<compareArray.length&&-1!==stockData[j][12].toLowerCase().search(compareArray[i]);i++)i===compareArray.length-1&&(hideFound?(parseInt(stockData[j][8])>0||parseInt(stockData[j][9])>0)&&filteredData.push(stockData[j]):filteredData.push(stockData[j]));hideFound&&(filteredData=filteredData.length>0?filteredData.filter(item=>parseInt(item[8])>0||parseInt(item[9])>0):0===compareArray.length?stockData.filter(item=>parseInt(item[8])>0||parseInt(item[9])>0):[])}else 0===compareArray.length?stockData.forEach(data=>{null!=data[0]&&(data[0].toLowerCase().includes(stockSearchInput.value.toLowerCase())||data[1].toLowerCase().includes(stockSearchInput.value.toLowerCase()))&&(hideFound?(parseInt(data[8])>0||parseInt(data[9])>0)&&filteredData.push(data):filteredData.push(data))}):filteredData=stockData.filter(data=>{for(let i=0;i<compareArray.length;i++){if(-1===data[12].toLowerCase().search(compareArray[i])||null==data[0]||!data[0].toLowerCase().includes(stockSearchInput.value.toLowerCase())&&!data[1].toLowerCase().includes(stockSearchInput.value.toLowerCase()))return!1;if(i===compareArray.length-1)return!hideFound||(parseInt(data[8])>0||parseInt(data[9])>0)}});resetStartEnd(),displayData(filteredData,stockStart,stockEnd)}}heading="retail"===stockListType?["Botanical Name","Common Name","Grade","$Retail","Height (m)","Standard Height (m)","Ready","In Production"]:["Botanical Name","Common Name","Grade","$Retail","$Wholesale","Height (m)","Standard Height (m)","Ready","In Production"],async function(){stockData=await fetch("https://api.leafland.co.nz/default/get-stock-data-file?type=list").then(response=>response.json()).catch(error=>{}),await displayData(stockData,stockStart,stockEnd),stockSearchInput.removeAttribute("disabled"),stockSearchInput.addEventListener("input",e=>{filterData()})}(),nextButton.addEventListener("click",()=>{stockStart+=25,stockEnd+=25,filteredData.length>1?displayData(filteredData,stockStart,stockEnd):displayData(stockData,stockStart,stockEnd)}),prevButton.addEventListener("click",()=>{stockStart-=25,stockEnd-=25,(stockStart<0||stockEnd<0)&&resetStartEnd(),filteredData.length>1?displayData(filteredData,stockStart,stockEnd):displayData(stockData,stockStart,stockEnd)}),hideOutOfStock.addEventListener("input",()=>{compareValue="",!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterEdible.checked&&(compareValue+="edible,"),!0===filterNative.checked&&(compareValue+="native,"),!0===filterDeciduous.checked&&(compareValue+="deciduous,"),!0===filterEvergreen.checked&&(compareValue+="evergreen,"),!0===filterSemiEvergreen.checked&&(compareValue+="semi-evergreen,"),filterData()}),filterEdible.addEventListener("input",()=>{compareValue="",!0===filterEdible.checked?(filterNative.disabled=!0,compareValue+="edible,"):filterNative.disabled=!1,!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterNative.checked&&(compareValue+="native,"),!0===filterDeciduous.checked&&(compareValue+="deciduous,"),!0===filterEvergreen.checked&&(compareValue+="evergreen,"),!0===filterSemiEvergreen.checked&&(compareValue+="semi-evergreen,"),filterData()}),filterNative.addEventListener("input",()=>{compareValue="",!0===filterNative.checked?(filterEdible.disabled=!0,compareValue+="native,"):filterEdible.disabled=!1,!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterEdible.checked&&(compareValue+="edible,"),!0===filterDeciduous.checked&&(compareValue+="deciduous,"),!0===filterEvergreen.checked&&(compareValue+="evergreen,"),!0===filterSemiEvergreen.checked&&(compareValue+="semi-evergreen,"),filterData()}),filterDeciduous.addEventListener("input",()=>{compareValue="",!0===filterDeciduous.checked?(filterEvergreen.disabled=!0,filterSemiEvergreen.disabled=!0,compareValue+="deciduous,"):(filterEvergreen.disabled=!1,filterSemiEvergreen.disabled=!1),!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterNative.checked&&(compareValue+="native,"),!0===filterEdible.checked&&(compareValue+="edible,"),!0===filterEvergreen.checked&&(compareValue+="evergreen,"),!0===filterSemiEvergreen.checked&&(compareValue+="semi-evergreen,"),filterData()}),filterEvergreen.addEventListener("input",()=>{compareValue="",!0===filterEvergreen.checked?(filterDeciduous.disabled=!0,filterSemiEvergreen.disabled=!0,compareValue+="evergreen,"):(filterDeciduous.disabled=!1,filterSemiEvergreen.disabled=!1),!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterNative.checked&&(compareValue+="native,"),!0===filterEdible.checked&&(compareValue+="edible,"),!0===filterDeciduous.checked&&(compareValue+="deciduous,"),!0===filterSemiEvergreen.checked&&(compareValue+="semi-evergreen,"),filterData()}),filterSemiEvergreen.addEventListener("input",()=>{compareValue="",!0===filterSemiEvergreen.checked?(filterDeciduous.disabled=!0,filterEvergreen.disabled=!0,compareValue+="semi-evergreen,"):(filterDeciduous.disabled=!1,filterEvergreen.disabled=!1),!0===hideOutOfStock.checked&&(compareValue+="hide,"),!0===filterNative.checked&&(compareValue+="native,"),!0===filterEdible.checked&&(compareValue+="edible,"),!0===filterDeciduous.checked&&(compareValue+="deciduous,"),!0===filterEvergreen.checked&&(compareValue+="evergreen,"),filterData()});